
(function(l, r) { if (!l || l.getElementById('livereloadscript')) return; r = l.createElement('script'); r.async = 1; r.src = '//' + (self.location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1'; r.id = 'livereloadscript'; l.getElementsByTagName('head')[0].appendChild(r) })(self.document);
(function(l, r) { if (!l || l.getElementById('livereloadscript')) return; r = l.createElement('script'); r.async = 1; r.src = '//' + (self.location.host || 'localhost').split(':')[0] + ':35730/livereload.js?snipver=1'; r.id = 'livereloadscript'; l.getElementsByTagName('head')[0].appendChild(r) })(self.document);
import { S as SvelteComponentDev, i as init, d as dispatch_dev, s as safe_not_equal, Y as Button, v as validate_slots, X as globals, Q as create_component, h as space, g as element, A as text, j as attr_dev, k as add_location, $ as set_style, R as mount_component, l as insert_dev, m as append_dev, D as listen_dev, B as set_data_dev, t as transition_in, o as transition_out, T as destroy_component, q as detach_dev, F as run_all, u as binding_callbacks, O as noop, a0 as src_url_equal } from './Portal-cdc68c5c.js';
import { M as Modal, a as ModalBody, b as ModalHeader } from './Modal-860cf855.js';
import { M as Menu } from './Menu-78e7509e.js';
import { S as Spinner_1 } from './Spinner-f8f93316.js';
import { i as isLoading } from './stores-f5db84d6.js';

/* src/Scraping.svelte generated by Svelte v3.59.2 */

const { console: console_1 } = globals;
const file = "src/Scraping.svelte";

// (86:2) <Button type="submit" outline color="light">
function create_default_slot_5(ctx) {
	let t;
	let i;

	const block = {
		c: function create() {
			t = text("企業情報を取得する ");
			i = element("i");
			attr_dev(i, "class", "fa fa-upload ml-2");
			add_location(i, file, 86, 13, 2156);
		},
		m: function mount(target, anchor) {
			insert_dev(target, t, anchor);
			insert_dev(target, i, anchor);
		},
		p: noop,
		d: function destroy(detaching) {
			if (detaching) detach_dev(t);
			if (detaching) detach_dev(i);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_default_slot_5.name,
		type: "slot",
		source: "(86:2) <Button type=\\\"submit\\\" outline color=\\\"light\\\">",
		ctx
	});

	return block;
}

// (89:2) <Button type="button" color="light" on:click={toggleModal}    >
function create_default_slot_4(ctx) {
	let t;
	let i;

	const block = {
		c: function create() {
			t = text("使い方がわからない方へ ");
			i = element("i");
			attr_dev(i, "class", "fa fa-question-circle ml-2");
			add_location(i, file, 89, 16, 2279);
		},
		m: function mount(target, anchor) {
			insert_dev(target, t, anchor);
			insert_dev(target, i, anchor);
		},
		p: noop,
		d: function destroy(detaching) {
			if (detaching) detach_dev(t);
			if (detaching) detach_dev(i);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_default_slot_4.name,
		type: "slot",
		source: "(89:2) <Button type=\\\"button\\\" color=\\\"light\\\" on:click={toggleModal}    >",
		ctx
	});

	return block;
}

// (94:3) <ModalHeader toggle={toggleModal}     >
function create_default_slot_3(ctx) {
	let t;

	const block = {
		c: function create() {
			t = text("企業情報リスト取得機能の使い方");
		},
		m: function mount(target, anchor) {
			insert_dev(target, t, anchor);
		},
		d: function destroy(detaching) {
			if (detaching) detach_dev(t);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_default_slot_3.name,
		type: "slot",
		source: "(94:3) <ModalHeader toggle={toggleModal}     >",
		ctx
	});

	return block;
}

// (120:4) <Button color="primary" on:click={toggleModal}>
function create_default_slot_2(ctx) {
	let t;

	const block = {
		c: function create() {
			t = text("閉じる");
		},
		m: function mount(target, anchor) {
			insert_dev(target, t, anchor);
		},
		d: function destroy(detaching) {
			if (detaching) detach_dev(t);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_default_slot_2.name,
		type: "slot",
		source: "(120:4) <Button color=\\\"primary\\\" on:click={toggleModal}>",
		ctx
	});

	return block;
}

// (97:3) <ModalBody class="modal-body">
function create_default_slot_1(ctx) {
	let ul;
	let li0;
	let h50;
	let t1;
	let p;
	let t3;
	let li1;
	let h51;
	let t5;
	let img0;
	let img0_src_value;
	let t6;
	let li2;
	let h52;
	let t8;
	let img1;
	let img1_src_value;
	let t9;
	let button;
	let current;

	button = new Button({
			props: {
				color: "primary",
				$$slots: { default: [create_default_slot_2] },
				$$scope: { ctx }
			},
			$$inline: true
		});

	button.$on("click", /*toggleModal*/ ctx[3]);

	const block = {
		c: function create() {
			ul = element("ul");
			li0 = element("li");
			h50 = element("h5");
			h50.textContent = "概要の説明";
			t1 = space();
			p = element("p");
			p.textContent = "調査対象の企業名が列挙されたCSVファイルをアップロードすることで、企業のホームページのURLが格納されたCSVファイルをダウンロードすることができます。";
			t3 = space();
			li1 = element("li");
			h51 = element("h5");
			h51.textContent = "アップロードするCSVファイルのサンプル";
			t5 = space();
			img0 = element("img");
			t6 = space();
			li2 = element("li");
			h52 = element("h5");
			h52.textContent = "ダウンロードされるファイルのサンプル";
			t8 = space();
			img1 = element("img");
			t9 = space();
			create_component(button.$$.fragment);
			add_location(h50, file, 99, 6, 2548);
			add_location(p, file, 100, 6, 2569);
			attr_dev(li0, "class", "item svelte-1otexly");
			add_location(li0, file, 98, 5, 2524);
			add_location(h51, file, 105, 6, 2709);
			if (!src_url_equal(img0.src, img0_src_value = "/static/images/upload_csv.png")) attr_dev(img0, "src", img0_src_value);
			attr_dev(img0, "alt", "アップロードCSVサンプル");
			attr_dev(img0, "class", "svelte-1otexly");
			add_location(img0, file, 106, 6, 2745);
			attr_dev(li1, "class", "item svelte-1otexly");
			add_location(li1, file, 104, 5, 2685);
			add_location(h52, file, 112, 6, 2869);
			if (!src_url_equal(img1.src, img1_src_value = "/static/images/download_csv.png")) attr_dev(img1, "src", img1_src_value);
			attr_dev(img1, "alt", "ダウンロードCSVサンプル");
			attr_dev(img1, "class", "svelte-1otexly");
			add_location(img1, file, 113, 6, 2903);
			attr_dev(li2, "class", "item svelte-1otexly");
			add_location(li2, file, 111, 5, 2845);
			add_location(ul, file, 97, 4, 2514);
		},
		m: function mount(target, anchor) {
			insert_dev(target, ul, anchor);
			append_dev(ul, li0);
			append_dev(li0, h50);
			append_dev(li0, t1);
			append_dev(li0, p);
			append_dev(ul, t3);
			append_dev(ul, li1);
			append_dev(li1, h51);
			append_dev(li1, t5);
			append_dev(li1, img0);
			append_dev(ul, t6);
			append_dev(ul, li2);
			append_dev(li2, h52);
			append_dev(li2, t8);
			append_dev(li2, img1);
			insert_dev(target, t9, anchor);
			mount_component(button, target, anchor);
			current = true;
		},
		p: function update(ctx, dirty) {
			const button_changes = {};

			if (dirty & /*$$scope*/ 256) {
				button_changes.$$scope = { dirty, ctx };
			}

			button.$set(button_changes);
		},
		i: function intro(local) {
			if (current) return;
			transition_in(button.$$.fragment, local);
			current = true;
		},
		o: function outro(local) {
			transition_out(button.$$.fragment, local);
			current = false;
		},
		d: function destroy(detaching) {
			if (detaching) detach_dev(ul);
			if (detaching) detach_dev(t9);
			destroy_component(button, detaching);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_default_slot_1.name,
		type: "slot",
		source: "(97:3) <ModalBody class=\\\"modal-body\\\">",
		ctx
	});

	return block;
}

// (93:2) <Modal isOpen={isModalOpen} toggle={toggleModal} size="lg">
function create_default_slot(ctx) {
	let modalheader;
	let t;
	let modalbody;
	let current;

	modalheader = new ModalHeader({
			props: {
				toggle: /*toggleModal*/ ctx[3],
				$$slots: { default: [create_default_slot_3] },
				$$scope: { ctx }
			},
			$$inline: true
		});

	modalbody = new ModalBody({
			props: {
				class: "modal-body",
				$$slots: { default: [create_default_slot_1] },
				$$scope: { ctx }
			},
			$$inline: true
		});

	const block = {
		c: function create() {
			create_component(modalheader.$$.fragment);
			t = space();
			create_component(modalbody.$$.fragment);
		},
		m: function mount(target, anchor) {
			mount_component(modalheader, target, anchor);
			insert_dev(target, t, anchor);
			mount_component(modalbody, target, anchor);
			current = true;
		},
		p: function update(ctx, dirty) {
			const modalheader_changes = {};

			if (dirty & /*$$scope*/ 256) {
				modalheader_changes.$$scope = { dirty, ctx };
			}

			modalheader.$set(modalheader_changes);
			const modalbody_changes = {};

			if (dirty & /*$$scope*/ 256) {
				modalbody_changes.$$scope = { dirty, ctx };
			}

			modalbody.$set(modalbody_changes);
		},
		i: function intro(local) {
			if (current) return;
			transition_in(modalheader.$$.fragment, local);
			transition_in(modalbody.$$.fragment, local);
			current = true;
		},
		o: function outro(local) {
			transition_out(modalheader.$$.fragment, local);
			transition_out(modalbody.$$.fragment, local);
			current = false;
		},
		d: function destroy(detaching) {
			destroy_component(modalheader, detaching);
			if (detaching) detach_dev(t);
			destroy_component(modalbody, detaching);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_default_slot.name,
		type: "slot",
		source: "(93:2) <Modal isOpen={isModalOpen} toggle={toggleModal} size=\\\"lg\\\">",
		ctx
	});

	return block;
}

function create_fragment(ctx) {
	let spinner;
	let t0;
	let form;
	let div2;
	let div0;
	let menu;
	let t1;
	let h1;
	let t3;
	let div1;
	let label;
	let i;
	let t4;
	let span0;
	let t6;
	let span1;
	let t7;
	let t8;
	let input;
	let t9;
	let button0;
	let t10;
	let button1;
	let t11;
	let modal;
	let current;
	let mounted;
	let dispose;
	spinner = new Spinner_1({ $$inline: true });
	menu = new Menu({ $$inline: true });

	button0 = new Button({
			props: {
				type: "submit",
				outline: true,
				color: "light",
				$$slots: { default: [create_default_slot_5] },
				$$scope: { ctx }
			},
			$$inline: true
		});

	button1 = new Button({
			props: {
				type: "button",
				color: "light",
				$$slots: { default: [create_default_slot_4] },
				$$scope: { ctx }
			},
			$$inline: true
		});

	button1.$on("click", /*toggleModal*/ ctx[3]);

	modal = new Modal({
			props: {
				isOpen: /*isModalOpen*/ ctx[0],
				toggle: /*toggleModal*/ ctx[3],
				size: "lg",
				$$slots: { default: [create_default_slot] },
				$$scope: { ctx }
			},
			$$inline: true
		});

	const block = {
		c: function create() {
			create_component(spinner.$$.fragment);
			t0 = space();
			form = element("form");
			div2 = element("div");
			div0 = element("div");
			create_component(menu.$$.fragment);
			t1 = space();
			h1 = element("h1");
			h1.textContent = "企業名リストCSVファイルをアップロードしてください";
			t3 = space();
			div1 = element("div");
			label = element("label");
			i = element("i");
			t4 = space();
			span0 = element("span");
			span0.textContent = "ファイルを選択";
			t6 = space();
			span1 = element("span");
			t7 = text(/*selectedFileName*/ ctx[1]);
			t8 = space();
			input = element("input");
			t9 = space();
			create_component(button0.$$.fragment);
			t10 = space();
			create_component(button1.$$.fragment);
			t11 = space();
			create_component(modal.$$.fragment);
			attr_dev(div0, "class", "menu-area svelte-1otexly");
			add_location(div0, file, 62, 2, 1560);
			attr_dev(h1, "class", "text-light");
			add_location(h1, file, 65, 2, 1607);
			attr_dev(i, "class", "fa fa-cloud-upload-alt fa-3x");
			add_location(i, file, 70, 4, 1742);
			attr_dev(span0, "class", "mt-2");
			add_location(span0, file, 71, 4, 1791);
			attr_dev(span1, "class", "mt-2 border-bottom");
			add_location(span1, file, 72, 4, 1829);
			attr_dev(input, "type", "file");
			attr_dev(input, "id", "fileUpload");
			attr_dev(input, "name", "fileUpload");
			set_style(input, "display", "none");
			attr_dev(input, "accept", ".csv");
			add_location(input, file, 73, 4, 1892);
			attr_dev(label, "class", "upload-container svelte-1otexly");
			add_location(label, file, 69, 3, 1705);
			attr_dev(div1, "class", "upload-container svelte-1otexly");
			add_location(div1, file, 68, 2, 1671);
			attr_dev(div2, "class", "screen svelte-1otexly");
			add_location(div2, file, 61, 1, 1537);
			add_location(form, file, 60, 0, 1504);
		},
		l: function claim(nodes) {
			throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option");
		},
		m: function mount(target, anchor) {
			mount_component(spinner, target, anchor);
			insert_dev(target, t0, anchor);
			insert_dev(target, form, anchor);
			append_dev(form, div2);
			append_dev(div2, div0);
			mount_component(menu, div0, null);
			append_dev(div2, t1);
			append_dev(div2, h1);
			append_dev(div2, t3);
			append_dev(div2, div1);
			append_dev(div1, label);
			append_dev(label, i);
			append_dev(label, t4);
			append_dev(label, span0);
			append_dev(label, t6);
			append_dev(label, span1);
			append_dev(span1, t7);
			append_dev(label, t8);
			append_dev(label, input);
			/*input_binding*/ ctx[6](input);
			append_dev(div2, t9);
			mount_component(button0, div2, null);
			append_dev(div2, t10);
			mount_component(button1, div2, null);
			append_dev(div2, t11);
			mount_component(modal, div2, null);
			current = true;

			if (!mounted) {
				dispose = [
					listen_dev(input, "input", /*handleFileChange*/ ctx[4], false, false, false, false),
					listen_dev(form, "submit", /*handleSubmit*/ ctx[5], false, false, false, false)
				];

				mounted = true;
			}
		},
		p: function update(ctx, [dirty]) {
			if (!current || dirty & /*selectedFileName*/ 2) set_data_dev(t7, /*selectedFileName*/ ctx[1]);
			const button0_changes = {};

			if (dirty & /*$$scope*/ 256) {
				button0_changes.$$scope = { dirty, ctx };
			}

			button0.$set(button0_changes);
			const button1_changes = {};

			if (dirty & /*$$scope*/ 256) {
				button1_changes.$$scope = { dirty, ctx };
			}

			button1.$set(button1_changes);
			const modal_changes = {};
			if (dirty & /*isModalOpen*/ 1) modal_changes.isOpen = /*isModalOpen*/ ctx[0];

			if (dirty & /*$$scope*/ 256) {
				modal_changes.$$scope = { dirty, ctx };
			}

			modal.$set(modal_changes);
		},
		i: function intro(local) {
			if (current) return;
			transition_in(spinner.$$.fragment, local);
			transition_in(menu.$$.fragment, local);
			transition_in(button0.$$.fragment, local);
			transition_in(button1.$$.fragment, local);
			transition_in(modal.$$.fragment, local);
			current = true;
		},
		o: function outro(local) {
			transition_out(spinner.$$.fragment, local);
			transition_out(menu.$$.fragment, local);
			transition_out(button0.$$.fragment, local);
			transition_out(button1.$$.fragment, local);
			transition_out(modal.$$.fragment, local);
			current = false;
		},
		d: function destroy(detaching) {
			destroy_component(spinner, detaching);
			if (detaching) detach_dev(t0);
			if (detaching) detach_dev(form);
			destroy_component(menu);
			/*input_binding*/ ctx[6](null);
			destroy_component(button0);
			destroy_component(button1);
			destroy_component(modal);
			mounted = false;
			run_all(dispose);
		}
	};

	dispatch_dev("SvelteRegisterBlock", {
		block,
		id: create_fragment.name,
		type: "component",
		source: "",
		ctx
	});

	return block;
}

function instance($$self, $$props, $$invalidate) {
	let { $$slots: slots = {}, $$scope } = $$props;
	validate_slots('Scraping', slots, []);
	let isModalOpen = false;
	let selectedFile;
	let selectedFileName = "";
	let fileInput;

	function toggleModal() {
		$$invalidate(0, isModalOpen = !isModalOpen);
	}

	function handleFileChange(event) {
		selectedFile = event.target.files[0];
		$$invalidate(1, selectedFileName = selectedFile.name);
	}

	async function handleSubmit(event) {
		event.preventDefault(); // デフォルトのフォーム送信を防止

		if (!selectedFile) {
			alert("ファイルが選択されていません。");
			return;
		}

		isLoading.set(true);
		const formData = new FormData();
		formData.append("fileUpload", selectedFile);

		try {
			const response = await fetch("/upload", { method: "POST", body: formData });

			if (response.ok) {
				const blob = await response.blob();
				const downloadUrl = window.URL.createObjectURL(blob);
				const a = document.createElement("a");
				a.style.display = "none";
				a.href = downloadUrl;
				a.download = response.headers.get("Content-Disposition").match(/filename="?(.+)"?/)[1];
				document.body.appendChild(a);
				a.click();
				document.body.removeChild(a);
			} else {
				console.error("Upload failed");
			}
		} catch(error) {
			console.error("Upload failed:", error);
		}

		isLoading.set(false);
		$$invalidate(2, fileInput.value = "", fileInput);
		selectedFile = null;
		$$invalidate(1, selectedFileName = "");
	}

	const writable_props = [];

	Object.keys($$props).forEach(key => {
		if (!~writable_props.indexOf(key) && key.slice(0, 2) !== '$$' && key !== 'slot') console_1.warn(`<Scraping> was created with unknown prop '${key}'`);
	});

	function input_binding($$value) {
		binding_callbacks[$$value ? 'unshift' : 'push'](() => {
			fileInput = $$value;
			$$invalidate(2, fileInput);
		});
	}

	$$self.$capture_state = () => ({
		Button,
		Modal,
		ModalBody,
		ModalHeader,
		Menu,
		Spinner: Spinner_1,
		isLoading,
		isModalOpen,
		selectedFile,
		selectedFileName,
		fileInput,
		toggleModal,
		handleFileChange,
		handleSubmit
	});

	$$self.$inject_state = $$props => {
		if ('isModalOpen' in $$props) $$invalidate(0, isModalOpen = $$props.isModalOpen);
		if ('selectedFile' in $$props) selectedFile = $$props.selectedFile;
		if ('selectedFileName' in $$props) $$invalidate(1, selectedFileName = $$props.selectedFileName);
		if ('fileInput' in $$props) $$invalidate(2, fileInput = $$props.fileInput);
	};

	if ($$props && "$$inject" in $$props) {
		$$self.$inject_state($$props.$$inject);
	}

	return [
		isModalOpen,
		selectedFileName,
		fileInput,
		toggleModal,
		handleFileChange,
		handleSubmit,
		input_binding
	];
}

class Scraping extends SvelteComponentDev {
	constructor(options) {
		super(options);
		init(this, options, instance, create_fragment, safe_not_equal, {});

		dispatch_dev("SvelteRegisterComponent", {
			component: this,
			tagName: "Scraping",
			options,
			id: create_fragment.name
		});
	}
}

const app = new Scraping({
	target: document.body,
	props: {
		name: 'scraping'
	}
});

export { app as default };
//# sourceMappingURL=scraping.js.map
